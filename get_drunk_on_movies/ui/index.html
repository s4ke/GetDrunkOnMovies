<html>
<head>
	<link href='http://fonts.googleapis.com/css?family=Fauna+One' rel='stylesheet' type='text/css'>
	<style type="text/css">
		
		body {
			font-family: 'Fauna One', serif;
			color: fff;
			background-color: CC0033;
		}
		
		.movieTitle {
			cursor: hand;
			cursor: pointer;
			font-family: 'Fauna One', serif;
		}
		
	</style>
	<script src="/js/jquery-2.0.2.js"></script>
	<script>

		function showAll() {
			$.getJSON("http://localhost:8080/?allMovies", {}, 
				function(data) {
					var display = $('#display');
					display.html('');
					for(var i = 0; i < data.length; ++i) {
						var movieTitleContainer = $('<div class="movieTitle">' + (i+1) + '. ' + data[i] + '</div>');
						movieTitleContainer.data('name', data[i]);
						display.append(movieTitleContainer);
					}
					addEvents();
				});
		}
		
		function showOne(movie) {
			$.getJSON("http://localhost:8080/", {
					'movie' : movie
				}, function(data) {
					var display = $('#display');
					display.html('');
					for(var i = 0; i < data.length; ++i) {
						var instance = data[i];
						addMovieToDiv(display, instance);
					}
					addEvents();
				});
		}
		
		function addMovieToDiv(div, movie) {
			var drink = movie['drink'];
			var name = movie['name'];
			if(drink !== null && name !== null) {
				var movieTitleContainer = $('<div class="movieTitle">' + name + '</div>');
				movieTitleContainer.data('name', name);
				div.append(movieTitleContainer);
				var drinkContainer = $('<div>');
				for(var occasion in drink) {
					var drinkDiv = $('<div>');
					drinkDiv.attr('class', 'drink');
					drinkDiv.append(occasion + ' : ' + drink[occasion]);
					drinkContainer.append(drinkDiv);
				}
				div.append(drinkContainer);
			}
		}
		
		function addEvents() {
			$('.movieTitle').click(function(event) {
				showOne($(event.target).data('name'));
			});
		}

	</script>
</head>
<body>

	<h1>Get Drunk on Movies!</h1>
	<p>Tired of getting drunk without any sense?<br>
	Watching movies normally is going on your nerves?<br>
	Yes? Then this site has the answer for you!<br>
	Just select a movie from the list below and<br>
	drink on every occasion that is recommended! :)</p>
	<p>The detailed info for every movie shows<br>
	a list of occasions on which you should drink<br>
	and the amount of occurences in the specific movie.</p>
	<p>If you have some nice additions to the list<br>
	just write an e-mail to
	<a href="mailto:test@test.com">test@test.com</a>.
	</p>

	<button type="button" onclick="showAll()">Show All Movies</button>
	<div id="display"></div>

</body>
</html>